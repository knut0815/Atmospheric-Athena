<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Atmospheric Athena: Atmospheric-Athena/src/prob/linear_wave1d.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Atmospheric Athena
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d72a5be45d0550369e5d60be167cce07.html">Atmospheric-Athena</a></li><li class="navelem"><a class="el" href="dir_d0e7bb5c4ff29ebf76eab911196cb2f6.html">src</a></li><li class="navelem"><a class="el" href="dir_e13a19de2a85be7802e3bc4dc41d6306.html">prob</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">linear_wave1d.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="linear__wave1d_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="copyright_8h.html">copyright.h</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/*============================================================================*/</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/*============================================================================*/</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;defs.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="athena_8h.html">athena.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="globals_8h.html">globals.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;prototypes.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/* Initial solution on root level, shared with Userwork_after_loop  */</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">static</span> <a class="code" href="struct_cons_s.html">ConsS</a> ***RootSoln=NULL;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> wave_flag;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/* problem:   */</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#a1b323f47153f1975b64382e0ffac6b73">   42</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="linear__wave1d_8c.html#a1b323f47153f1975b64382e0ffac6b73">problem</a>(<a class="code" href="struct_domain_s.html">DomainS</a> *pDomain)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="struct_grid_s.html">GridS</a> *pGrid=(pDomain-&gt;Grid);</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="struct_cons_s.html">ConsS</a> ***Soln;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> i=0,j=0,k=0;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">int</span> is,ie,js,je,ks,ke,n,m,nx1,nx2,nx3,wave_dir;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  Real <a class="code" href="par__epicycle_8c.html#ad5a0b25666982c302ce2cc5597eb95d3">amp</a>,vflow;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  Real d0,p0,u0,v0,w0,h0;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  Real x1,x2,x3,r,ev[NWAVE],rem[NWAVE][NWAVE],lem[NWAVE][NWAVE];</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  Real bx0,by0,bz0,xfact,yfact;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  is = pGrid-&gt;is; ie = pGrid-&gt;ie;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  js = pGrid-&gt;js; je = pGrid-&gt;je;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  ks = pGrid-&gt;ks; ke = pGrid-&gt;ke;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  nx1 = (ie-is)+1 + 2*nghost;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  nx2 = (je-js)+1 + 2*nghost;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  nx3 = (ke-ks)+1 + 2*nghost;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">/* Read initial conditions  */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  wave_flag = <a class="code" href="par_8c.html#ac03bbd5713f3a93db722aea8d1c1b5c0">par_geti</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;wave_flag&quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  amp = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;amp&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  vflow = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;vflow&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  wave_dir = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;wave_dir&quot;</span>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/* allocate memory for solution on this level.  If this is root level</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * also allocate memory for RootSoln */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">if</span> ((Soln = (<a class="code" href="struct_cons_s.html">ConsS</a>***)<a class="code" href="ath__array_8c.html#aaa55b7239bfb912dcdaaf2190ee20b65">calloc_3d_array</a>(nx3,nx2,nx1,<span class="keyword">sizeof</span>(<a class="code" href="struct_cons_s.html">ConsS</a>)))==NULL)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6">ath_error</a>(<span class="stringliteral">&quot;[problem]: Error allocating memory for Soln\n&quot;</span>);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">if</span> (pDomain-&gt;Level == 0){</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">if</span> ((RootSoln = (<a class="code" href="struct_cons_s.html">ConsS</a>***)<a class="code" href="ath__array_8c.html#aaa55b7239bfb912dcdaaf2190ee20b65">calloc_3d_array</a>(nx3,nx2,nx1,<span class="keyword">sizeof</span>(<a class="code" href="struct_cons_s.html">ConsS</a>)))</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      == NULL) <a class="code" href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6">ath_error</a>(<span class="stringliteral">&quot;[problem]: Error alloc memory for RootSoln\n&quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">/* Get eigenmatrix, where the quantities u0 and bx0 are parallel to the</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> * wavevector, and v0,w0,by0,bz0 are perpendicular.  Background state chosen</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> * carefully so wave speeds are well-separated: Va=1, Vf=2, Vs=0.5 */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  d0 = 1.0;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  p0 = 1.0/Gamma;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  u0 = vflow*sqrt(Gamma*p0/d0);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  u0 = vflow*Iso_csound;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  v0 = 0.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  w0 = 0.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  bx0 = 1.0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  by0 = sqrt(2.0);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  bz0 = 0.5;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  xfact = 0.0;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  yfact = 1.0;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="keywordflow">for</span> (n=0; n&lt;NWAVE; n++) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">for</span> (m=0; m&lt;NWAVE; m++) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      rem[n][m] = 0.0;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      lem[n][m] = 0.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#ifdef HYDRO</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#ifdef ISOTHERMAL</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="rsolvers_2prototypes_8h.html#a969e92dbb8d373dd53ddf26af8484dc8">esys_roe_iso_hyd</a>(u0,v0,w0,   ev,rem,lem);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  h0 = ((p0/Gamma_1 + 0.5*d0*(u0*u0+v0*v0+w0*w0)) + p0)/d0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="rsolvers_2prototypes_8h.html#aec330950c874b52ea896e87bf5c510de">esys_roe_adb_hyd</a>(u0,v0,w0,h0,ev,rem,lem);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Cs = %e, %e\n&quot;</span>,ev[0],rem[0][wave_flag]);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux      = %e, %e\n&quot;</span>,ev[1],rem[1][wave_flag]);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Cs = %e, %e\n&quot;</span>,ev[4],rem[4][wave_flag]);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* HYDRO */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">#if defined(ISOTHERMAL)</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="rsolvers_2prototypes_8h.html#a24d020d44742ab1c876ca77a0780a8c4">esys_roe_iso_mhd</a>(d0,u0,v0,w0,bx0,by0,bz0,xfact,yfact,ev,rem,lem);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Cf = %e, %e\n&quot;</span>,ev[0],rem[0][wave_flag]);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Ca = %e, %e\n&quot;</span>,ev[1],rem[1][wave_flag]);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Cs = %e, %e\n&quot;</span>,ev[2],rem[2][wave_flag]);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Cs = %e, %e\n&quot;</span>,ev[3],rem[3][wave_flag]);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Ca = %e, %e\n&quot;</span>,ev[4],rem[4][wave_flag]);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Cf = %e, %e\n&quot;</span>,ev[5],rem[5][wave_flag]);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  h0 = ((p0/Gamma_1+0.5*(bx0*bx0+by0*by0+bz0*bz0)+0.5*d0*(u0*u0+v0*v0+w0*w0))</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;               + (p0+0.5*(bx0*bx0+by0*by0+bz0*bz0)))/d0;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="rsolvers_2prototypes_8h.html#a4c072a7acb3407ef179cb922028efb2e">esys_roe_adb_mhd</a>(d0,u0,v0,w0,h0,bx0,by0,bz0,xfact,yfact,ev,rem,lem);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Cf = %e, %e\n&quot;</span>,ev[0],rem[0][wave_flag]);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Ca = %e, %e\n&quot;</span>,ev[1],rem[1][wave_flag]);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux - Cs = %e, %e\n&quot;</span>,ev[2],rem[2][wave_flag]);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux      = %e, %e\n&quot;</span>,ev[3],rem[3][wave_flag]);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Cs = %e, %e\n&quot;</span>,ev[4],rem[4][wave_flag]);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Ca = %e, %e\n&quot;</span>,ev[5],rem[5][wave_flag]);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a>(0,<span class="stringliteral">&quot;Ux + Cf = %e, %e\n&quot;</span>,ev[6],rem[6][wave_flag]);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">/* Now initialize 1D solution vector  */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keywordflow">for</span> (k=ks; k&lt;=ke; k++) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">for</span> (j=js; j&lt;=je; j++) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <span class="keywordflow">for</span> (i=is; i&lt;=ie; i++) {</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/* Set background state */</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="cc__pos_8c.html#a9204d609430c459b0ace484b66dca353">cc_pos</a>(pGrid,i,j,k,&amp;x1,&amp;x2,&amp;x3);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    Soln[k][j][i].d = d0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    Soln[k][j][i].E = p0/Gamma_1 + 0.5*d0*u0*u0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    Soln[k][j][i].E += 0.5*(bx0*bx0 + by0*by0 + bz0*bz0);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">/* Select appropriate solution based on direction of wavevector */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">switch</span>(wave_dir){</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/* wave in x1-direction */</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      Soln[k][j][i].d += amp*sin(2.0*PI*x1)*rem[0][wave_flag];</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      Soln[k][j][i].E += amp*sin(2.0*PI*x1)*rem[4][wave_flag];</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      Soln[k][j][i].M1 = d0*vflow;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      Soln[k][j][i].M2 = 0.0;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      Soln[k][j][i].M3 = 0.0;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      Soln[k][j][i].M1 += amp*sin(2.0*PI*x1)*rem[1][wave_flag];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      Soln[k][j][i].M2 += amp*sin(2.0*PI*x1)*rem[2][wave_flag];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      Soln[k][j][i].M3 += amp*sin(2.0*PI*x1)*rem[3][wave_flag];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      Soln[k][j][i].B1c = bx0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      Soln[k][j][i].B2c = by0 + amp*sin(2.0*PI*x1)*rem[NWAVE-2][wave_flag];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      Soln[k][j][i].B3c = bz0 + amp*sin(2.0*PI*x1)*rem[NWAVE-1][wave_flag];</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        Soln[k][j][i].<a class="code" href="streaming2d__single_8c.html#a0e63b0ad913b68a68ba39aa88ab60cb3">s</a>[n] = amp*(1.0 + sin(2.0*PI*x1));</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">/* Wave in x2-direction */</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      Soln[k][j][i].d += amp*sin(2.0*PI*x2)*rem[0][wave_flag];</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      Soln[k][j][i].E += amp*sin(2.0*PI*x2)*rem[4][wave_flag];</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      Soln[k][j][i].M1 = 0.0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      Soln[k][j][i].M2 = d0*vflow;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      Soln[k][j][i].M3 = 0.0;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      Soln[k][j][i].M1 += amp*sin(2.0*PI*x2)*rem[3][wave_flag];</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      Soln[k][j][i].M2 += amp*sin(2.0*PI*x2)*rem[1][wave_flag];</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      Soln[k][j][i].M3 += amp*sin(2.0*PI*x2)*rem[2][wave_flag];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      Soln[k][j][i].B1c = bz0 + amp*sin(2.0*PI*x2)*rem[NWAVE-1][wave_flag];</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      Soln[k][j][i].B2c = bx0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      Soln[k][j][i].B3c = by0 + amp*sin(2.0*PI*x2)*rem[NWAVE-2][wave_flag];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++)</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        Soln[k][j][i].<a class="code" href="streaming2d__single_8c.html#a0e63b0ad913b68a68ba39aa88ab60cb3">s</a>[n] = amp*(1.0 + sin(2.0*PI*x2));</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">/* Wave in x3-direction */</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      Soln[k][j][i].d += amp*sin(2.0*PI*x3)*rem[0][wave_flag];</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      Soln[k][j][i].E += amp*sin(2.0*PI*x3)*rem[4][wave_flag];</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      Soln[k][j][i].M1 = 0.0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      Soln[k][j][i].M2 = 0.0;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      Soln[k][j][i].M3 = d0*vflow;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      Soln[k][j][i].M1 += amp*sin(2.0*PI*x3)*rem[2][wave_flag];</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      Soln[k][j][i].M2 += amp*sin(2.0*PI*x3)*rem[3][wave_flag];</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      Soln[k][j][i].M3 += amp*sin(2.0*PI*x3)*rem[1][wave_flag];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      Soln[k][j][i].B1c = by0 + amp*sin(2.0*PI*x3)*rem[NWAVE-2][wave_flag];</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      Soln[k][j][i].B2c = bz0 + amp*sin(2.0*PI*x3)*rem[NWAVE-1][wave_flag];</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      Soln[k][j][i].B3c = bx0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        Soln[k][j][i].<a class="code" href="streaming2d__single_8c.html#a0e63b0ad913b68a68ba39aa88ab60cb3">s</a>[n] = amp*(1.0 + sin(2.0*PI*x3));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <a class="code" href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6">ath_error</a>(<span class="stringliteral">&quot;[linear_wave1d]: wave direction %d not allowed\n&quot;</span>,wave_dir);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  }}}</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">/* Now set initial conditions to wave solution */</span> </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">for</span> (k=ks; k&lt;=ke; k++) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">for</span> (j=js; j&lt;=je; j++) {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">for</span> (i=is; i&lt;=ie; i++) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    pGrid-&gt;U[k][j][i].d = Soln[k][j][i].d;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    pGrid-&gt;U[k][j][i].E = Soln[k][j][i].E;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    pGrid-&gt;U[k][j][i].M1 = Soln[k][j][i].M1;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    pGrid-&gt;U[k][j][i].M2 = Soln[k][j][i].M2;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    pGrid-&gt;U[k][j][i].M3 = Soln[k][j][i].M3;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    pGrid-&gt;U[k][j][i].B1c = Soln[k][j][i].B1c;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    pGrid-&gt;U[k][j][i].B2c = Soln[k][j][i].B2c;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    pGrid-&gt;U[k][j][i].B3c = Soln[k][j][i].B3c;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    pGrid-&gt;B1i[k][j][i] = Soln[k][j][i].B1c;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    pGrid-&gt;B2i[k][j][i] = Soln[k][j][i].B2c;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    pGrid-&gt;B3i[k][j][i] = Soln[k][j][i].B3c;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        pGrid-&gt;U[k][j][i].s[n] = Soln[k][j][i].s[n]; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;#endif</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  }}}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="keywordflow">for</span> (k=ks; k&lt;=ke; k++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">for</span> (j=js; j&lt;=je; j++) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      pGrid-&gt;B1i[k][j][ie+1] = pGrid-&gt;B1i[k][j][ie];</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordflow">if</span> (pGrid-&gt;Nx[1] &gt; 1) {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (k=ks; k&lt;=ke; k++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      <span class="keywordflow">for</span> (i=is; i&lt;=ie; i++) {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        pGrid-&gt;B2i[k][je+1][i] = pGrid-&gt;B2i[k][je][i];</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="keywordflow">if</span> (pGrid-&gt;Nx[2] &gt; 1) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">for</span> (j=js; j&lt;=je; j++) {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      <span class="keywordflow">for</span> (i=is; i&lt;=ie; i++) {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        pGrid-&gt;B3i[ke+1][j][i] = pGrid-&gt;B3i[ke][j][i];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  }</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">/* For self-gravitating problems, read 4\piG and compute mean density */</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#ifdef SELF_GRAVITY</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  four_pi_G = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;four_pi_G&quot;</span>);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  grav_mean_rho = d0;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SELF_GRAVITY */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">/* With viscosity and/or resistivity, read eta_R and nu_V */</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">#ifdef RESISTIVITY</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  eta_Ohm = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;eta_O&quot;</span>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  Q_AD    = <a class="code" href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf">par_getd_def</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;Q_AD&quot;</span>,0.0);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  d_ind   = <a class="code" href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf">par_getd_def</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;d_ind&quot;</span>,0.0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#ifdef NAVIER_STOKES</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  nu_V = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;nu&quot;</span>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/* save solution on root grid */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="keywordflow">if</span> (pDomain-&gt;Level == 0) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">for</span> (k=ks; k&lt;=ke; k++) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">for</span> (j=js; j&lt;=je; j++) {</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">for</span> (i=is; i&lt;=ie; i++) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      RootSoln[k][j][i].d  = Soln[k][j][i].d ;</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      RootSoln[k][j][i].M1 = Soln[k][j][i].M1;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      RootSoln[k][j][i].M2 = Soln[k][j][i].M2;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      RootSoln[k][j][i].M3 = Soln[k][j][i].M3;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      RootSoln[k][j][i].E  = Soln[k][j][i].E ;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      RootSoln[k][j][i].B1c = Soln[k][j][i].B1c;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      RootSoln[k][j][i].B2c = Soln[k][j][i].B2c;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;      RootSoln[k][j][i].B3c = Soln[k][j][i].B3c;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        RootSoln[k][j][i].<a class="code" href="streaming2d__single_8c.html#a0e63b0ad913b68a68ba39aa88ab60cb3">s</a>[n] = Soln[k][j][i].<a class="code" href="streaming2d__single_8c.html#a0e63b0ad913b68a68ba39aa88ab60cb3">s</a>[n];</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }}}</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  }</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <a class="code" href="ath__array_8c.html#aa639a50b59af0bc55505fe267a0ec5a1">free_3d_array</a>(Soln);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;}</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/*==============================================================================</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"> * PROBLEM USER FUNCTIONS:</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * problem_write_restart() - writes problem-specific user data to restart files</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> * problem_read_restart()  - reads problem-specific user data from restart files</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> * get_usr_expr()          - sets pointer to expression for special output data</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> * get_usr_out_fun()       - returns a user defined output function pointer</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> * get_usr_par_prop()      - returns a user defined particle selection function</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"> * Userwork_in_loop        - problem specific work IN     main loop</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"> * Userwork_after_loop     - problem specific work AFTER  main loop</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> *----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#a2c334369ab621e9815591c76ccfb5fc7">  344</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="linear__wave1d_8c.html#a2c334369ab621e9815591c76ccfb5fc7">problem_write_restart</a>(<a class="code" href="struct_mesh_s.html">MeshS</a> *pM, FILE *fp)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;{</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#acf733c9792756cbec1e9d226c4ff37ab">  349</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="linear__wave1d_8c.html#acf733c9792756cbec1e9d226c4ff37ab">problem_read_restart</a>(<a class="code" href="struct_mesh_s.html">MeshS</a> *pM, FILE *fp)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;{</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#ifdef SELF_GRAVITY</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  Real d0 = 1.0;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  four_pi_G = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;four_pi_G&quot;</span>);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  grav_mean_rho = d0;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SELF_GRAVITY */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="preprocessor">#ifdef RESISTIVITY</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  eta_Ohm = <a class="code" href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf">par_getd_def</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;eta_O&quot;</span>,0.0);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  Q_Hall  = <a class="code" href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf">par_getd_def</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;Q_H&quot;</span>,0.0);</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  Q_AD    = <a class="code" href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf">par_getd_def</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;Q_AD&quot;</span>,0.0);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="preprocessor">#ifdef NAVIER_STOKES</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  nu_V = <a class="code" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a>(<span class="stringliteral">&quot;problem&quot;</span>,<span class="stringliteral">&quot;nu&quot;</span>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#a4575c4cdbf2965a9857c45970d736676">  367</a></span>&#160;<a class="code" href="athena_8h.html#aaa64b3ee5eefc566b7c09368c414de89">ConsFun_t</a> <a class="code" href="linear__wave1d_8c.html#a4575c4cdbf2965a9857c45970d736676">get_usr_expr</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *expr)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;{</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;}</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00372"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#a8b8cabb1061d5399fb492be89de213ff">  372</a></span>&#160;<a class="code" href="athena_8h.html#a8bc2403d4d3a27d6f475f2dc6acc94cc">VOutFun_t</a> <a class="code" href="linear__wave1d_8c.html#a8b8cabb1061d5399fb492be89de213ff">get_usr_out_fun</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="par__circ_8c.html#ae5cb967283dbbdf75cb2032c1fa08fee">name</a>){</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#ifdef RESISTIVITY</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="keywordtype">void</span> get_eta_user(<a class="code" href="struct_grid_s.html">GridS</a> *pG, <span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                             Real *eta_O, Real *eta_H, Real *eta_A)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;{</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  *eta_O = 0.0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  *eta_H = 0.0;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  *eta_A = 0.0;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#a0ff640c24db1dc0d7c89d91f1d55ffce">  391</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="linear__wave1d_8c.html#a0ff640c24db1dc0d7c89d91f1d55ffce">Userwork_in_loop</a>(<a class="code" href="struct_mesh_s.html">MeshS</a> *pM)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;}</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">/*------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"> * Userwork_after_loop: computes L1-error in linear waves,</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"> * ASSUMING WAVE HAS PROPAGATED AN INTEGER NUMBER OF PERIODS</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment"> * Must set parameters (tlim, wavespeeds, box size) in input file appropriately</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"> * so that this is true</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment"> * With nested grids, computes L1 error only on root grid (level=0).</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno"><a class="line" href="linear__wave1d_8c.html#a5506a1df41ed88e038443271b9785337">  403</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="linear__wave1d_8c.html#a5506a1df41ed88e038443271b9785337">Userwork_after_loop</a>(<a class="code" href="struct_mesh_s.html">MeshS</a> *pM)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="struct_grid_s.html">GridS</a> *pGrid;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="keywordtype">int</span> i=0,j=0,k=0;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="keywordtype">int</span> is,ie,js,je,ks,ke;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  Real rms_error=0.0;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="struct_cons_s.html">ConsS</a> error,total_error;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  FILE *fp;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">char</span> *fname;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordtype">int</span> Nx1, Nx2, Nx3, count;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  total_error.d = 0.0;</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  total_error.M1 = 0.0;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  total_error.M2 = 0.0;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  total_error.M3 = 0.0;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  total_error.B1c = 0.0;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  total_error.B2c = 0.0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  total_error.B3c = 0.0;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  total_error.E = 0.0;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) total_error.s[n] = 0.0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;#endif</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">/* Compute error only on root Grid, which is in Domain[0][0] */</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  pGrid=pM-&gt;Domain[0][0].Grid;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  if (pGrid == NULL) <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">/* compute L1 error in each variable, and rms total error */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  is = pGrid-&gt;is; ie = pGrid-&gt;ie;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  js = pGrid-&gt;js; je = pGrid-&gt;je;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  ks = pGrid-&gt;ks; ke = pGrid-&gt;ke;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">for</span> (k=ks; k&lt;=ke; k++) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="keywordflow">for</span> (j=js; j&lt;=je; j++) {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    error.d = 0.0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    error.M1 = 0.0;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    error.M2 = 0.0;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    error.M3 = 0.0;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    error.B1c = 0.0;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    error.B2c = 0.0;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    error.B3c = 0.0;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    error.E = 0.0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) error.s[n] = 0.0;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;#endif</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    for (i=is; i&lt;=ie; i++) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      error.d   += fabs(pGrid-&gt;U[k][j][i].d   - RootSoln[k][j][i].d );</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      error.M1  += fabs(pGrid-&gt;U[k][j][i].M1  - RootSoln[k][j][i].M1);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      error.M2  += fabs(pGrid-&gt;U[k][j][i].M2  - RootSoln[k][j][i].M2);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      error.M3  += fabs(pGrid-&gt;U[k][j][i].M3  - RootSoln[k][j][i].M3); </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      error.B1c += fabs(pGrid-&gt;U[k][j][i].B1c - RootSoln[k][j][i].B1c);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      error.B2c += fabs(pGrid-&gt;U[k][j][i].B2c - RootSoln[k][j][i].B2c);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      error.B3c += fabs(pGrid-&gt;U[k][j][i].B3c - RootSoln[k][j][i].B3c);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      error.E   += fabs(pGrid-&gt;U[k][j][i].E   - RootSoln[k][j][i].E );</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        error.s[n] += fabs(pGrid-&gt;U[k][j][i].s[n] - RootSoln[k][j][i].s[n]);;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    total_error.d += error.d;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    total_error.M1 += error.M1;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    total_error.M2 += error.M2;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    total_error.M3 += error.M3;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    total_error.B1c += error.B1c;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    total_error.B2c += error.B2c;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    total_error.B3c += error.B3c;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    total_error.E += error.E;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) total_error.s[n] += error.s[n];</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;#endif</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }}</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  Nx1 = ie - is + 1;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;  Nx2 = je - js + 1;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  Nx3 = ke - ks + 1;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  count = Nx1*Nx2*Nx3;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">/* Compute RMS error over all variables, and print out */</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  rms_error = SQR(total_error.d) + SQR(total_error.M1) + SQR(total_error.M2)</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                + SQR(total_error.M3);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  rms_error += SQR(total_error.B1c) + SQR(total_error.B2c) </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;               + SQR(total_error.B3c);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  rms_error += SQR(total_error.E);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  rms_error = sqrt(rms_error)/(double)count;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">/* Print error to file &quot;LinWave-errors.#.dat&quot;, where #=wave_flag  */</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  fname = <a class="code" href="ath__files_8c.html#a4c77811377d9605b4a52b830515b2a62">ath_fname</a>(NULL,<span class="stringliteral">&quot;LinWave-errors&quot;</span>,NULL,NULL,1,wave_flag,NULL,<span class="stringliteral">&quot;dat&quot;</span>);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">/* The file exists -- reopen the file in append mode */</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keywordflow">if</span>((fp=fopen(fname,<span class="stringliteral">&quot;r&quot;</span>)) != NULL){</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordflow">if</span>((fp = freopen(fname,<span class="stringliteral">&quot;a&quot;</span>,fp)) == NULL){</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;      <a class="code" href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6">ath_error</a>(<span class="stringliteral">&quot;[Userwork_after_loop]: Unable to reopen file.\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  }</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">/* The file does not exist -- open the file in write mode */</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">else</span>{</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span>((fp = fopen(fname,<span class="stringliteral">&quot;w&quot;</span>)) == NULL){</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <a class="code" href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6">ath_error</a>(<span class="stringliteral">&quot;[Userwork_after_loop]: Unable to open file.\n&quot;</span>);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/* Now write out some header information */</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    fprintf(fp,<span class="stringliteral">&quot;# Nx1  Nx2  Nx3  RMS-Error  d  M1  M2  M3&quot;</span>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    fprintf(fp,<span class="stringliteral">&quot;  E&quot;</span>);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    fprintf(fp,<span class="stringliteral">&quot;  B1c  B2c  B3c&quot;</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      fprintf(fp,<span class="stringliteral">&quot;  S[ %d ]&quot;</span>,n);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    fprintf(fp,<span class="stringliteral">&quot;\n#\n&quot;</span>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;  }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  fprintf(fp,<span class="stringliteral">&quot;%d  %d  %d  %e&quot;</span>,Nx1,Nx2,Nx3,rms_error);</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  fprintf(fp,<span class="stringliteral">&quot;  %e  %e  %e  %e&quot;</span>,</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      (total_error.d/(<span class="keywordtype">double</span>) count),</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;      (total_error.M1/(<span class="keywordtype">double</span>)count),</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;      (total_error.M2/(<span class="keywordtype">double</span>)count),</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      (total_error.M3/(<span class="keywordtype">double</span>)count));</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor">#ifndef ISOTHERMAL</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  fprintf(fp,<span class="stringliteral">&quot;  %e&quot;</span>,(total_error.E/(<span class="keywordtype">double</span>)count));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ISOTHERMAL */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="preprocessor">#ifdef MHD</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  fprintf(fp,<span class="stringliteral">&quot;  %e  %e  %e&quot;</span>,</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      (total_error.B1c/(<span class="keywordtype">double</span>)count),</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      (total_error.B2c/(<span class="keywordtype">double</span>)count),</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      (total_error.B3c/(<span class="keywordtype">double</span>)count));</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* MHD */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="preprocessor">#if (NSCALARS &gt; 0)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">for</span> (n=0; n&lt;NSCALARS; n++) {</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      fprintf(fp,<span class="stringliteral">&quot;  %e&quot;</span>,total_error.s[n]/(<span class="keywordtype">double</span>)count);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;  fprintf(fp,<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  fclose(fp);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;}</div>
<div class="ttc" id="athena_8h_html"><div class="ttname"><a href="athena_8h.html">athena.h</a></div><div class="ttdoc">Contains definitions of many data types and structures. </div></div>
<div class="ttc" id="par_8c_html_ac234e8c1085523fa6adcd6d4f48281b5"><div class="ttname"><a href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5">par_getd</a></div><div class="ttdeci">double par_getd(char *block, char *name)</div><div class="ttdoc">Return a Real value. </div><div class="ttdef"><b>Definition:</b> <a href="par_8c_source.html#l00277">par.c:277</a></div></div>
<div class="ttc" id="rsolvers_2prototypes_8h_html_a969e92dbb8d373dd53ddf26af8484dc8"><div class="ttname"><a href="rsolvers_2prototypes_8h.html#a969e92dbb8d373dd53ddf26af8484dc8">esys_roe_iso_hyd</a></div><div class="ttdeci">void esys_roe_iso_hyd(const Real v1, const Real v2, const Real v3, Real eigenvalues[], Real right_eigenmatrix[][4], Real left_eigenmatrix[][4])</div><div class="ttdoc">ISOTHERMAL HYDRO. </div></div>
<div class="ttc" id="ath__array_8c_html_aa639a50b59af0bc55505fe267a0ec5a1"><div class="ttname"><a href="ath__array_8c.html#aa639a50b59af0bc55505fe267a0ec5a1">free_3d_array</a></div><div class="ttdeci">void free_3d_array(void *array)</div><div class="ttdoc">Free memory used by 3D array. </div><div class="ttdef"><b>Definition:</b> <a href="ath__array_8c_source.html#l00144">ath_array.c:144</a></div></div>
<div class="ttc" id="athena_8h_html_aaa64b3ee5eefc566b7c09368c414de89"><div class="ttname"><a href="athena_8h.html#aaa64b3ee5eefc566b7c09368c414de89">ConsFun_t</a></div><div class="ttdeci">Real(* ConsFun_t)(const GridS *pG, const int i, const int j, const int k)</div><div class="ttdoc">Pointer to expression that computes quant for output. </div><div class="ttdef"><b>Definition:</b> <a href="athena_8h_source.html#l00439">athena.h:439</a></div></div>
<div class="ttc" id="struct_domain_s_html"><div class="ttname"><a href="struct_domain_s.html">DomainS</a></div><div class="ttdoc">Information about one region of Mesh at some particular level. </div></div>
<div class="ttc" id="athena_8h_html_a8bc2403d4d3a27d6f475f2dc6acc94cc"><div class="ttname"><a href="athena_8h.html#a8bc2403d4d3a27d6f475f2dc6acc94cc">VOutFun_t</a></div><div class="ttdeci">void(* VOutFun_t)(MeshS *pM, struct Output_s *pout)</div><div class="ttdoc">Output function pointer. </div><div class="ttdef"><b>Definition:</b> <a href="athena_8h_source.html#l00433">athena.h:433</a></div></div>
<div class="ttc" id="rsolvers_2prototypes_8h_html_a24d020d44742ab1c876ca77a0780a8c4"><div class="ttname"><a href="rsolvers_2prototypes_8h.html#a24d020d44742ab1c876ca77a0780a8c4">esys_roe_iso_mhd</a></div><div class="ttdeci">void esys_roe_iso_mhd(const Real d, const Real v1, const Real v2, const Real v3, const Real b1, const Real b2, const Real b3, const Real x, const Real y, Real eigenvalues[], Real right_eigenmatrix[][6], Real left_eigenmatrix[][6])</div><div class="ttdoc">ISOTHERMAL MHD. </div></div>
<div class="ttc" id="linear__wave1d_8c_html_acf733c9792756cbec1e9d226c4ff37ab"><div class="ttname"><a href="linear__wave1d_8c.html#acf733c9792756cbec1e9d226c4ff37ab">problem_read_restart</a></div><div class="ttdeci">void problem_read_restart(MeshS *pM, FILE *fp)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00349">linear_wave1d.c:349</a></div></div>
<div class="ttc" id="globals_8h_html"><div class="ttname"><a href="globals_8h.html">globals.h</a></div><div class="ttdoc">Contains global variables. </div></div>
<div class="ttc" id="struct_grid_s_html"><div class="ttname"><a href="struct_grid_s.html">GridS</a></div><div class="ttdoc">3D arrays of dependent variables, plus grid data, plus particle data, plus data about child and paren...</div></div>
<div class="ttc" id="linear__wave1d_8c_html_a8b8cabb1061d5399fb492be89de213ff"><div class="ttname"><a href="linear__wave1d_8c.html#a8b8cabb1061d5399fb492be89de213ff">get_usr_out_fun</a></div><div class="ttdeci">VOutFun_t get_usr_out_fun(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00372">linear_wave1d.c:372</a></div></div>
<div class="ttc" id="par_8c_html_a0f36a2890d652e2c2ca86d72c91cc8cf"><div class="ttname"><a href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf">par_getd_def</a></div><div class="ttdeci">double par_getd_def(char *block, char *name, double def)</div><div class="ttdoc">Return double *name in *block if it exists, else use the double def as a default value. </div><div class="ttdef"><b>Definition:</b> <a href="par_8c_source.html#l00320">par.c:320</a></div></div>
<div class="ttc" id="rsolvers_2prototypes_8h_html_a4c072a7acb3407ef179cb922028efb2e"><div class="ttname"><a href="rsolvers_2prototypes_8h.html#a4c072a7acb3407ef179cb922028efb2e">esys_roe_adb_mhd</a></div><div class="ttdeci">void esys_roe_adb_mhd(const Real d, const Real v1, const Real v2, const Real v3, const Real h, const Real b1, const Real b2, const Real b3, const Real x, const Real y, Real eigenvalues[], Real right_eigenmatrix[][7], Real left_eigenmatrix[][7])</div></div>
<div class="ttc" id="prototypes_8h_html_ab4a402b1bd69e8f49435ee8fe45ecce6"><div class="ttname"><a href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6">ath_error</a></div><div class="ttdeci">void ath_error(char *fmt,...)</div><div class="ttdoc">Terminate execution and output error message Uses variable-length argument lists provided in <stdarg...</div><div class="ttdef"><b>Definition:</b> <a href="utils_8c_source.html#l00118">utils.c:118</a></div></div>
<div class="ttc" id="ath__array_8c_html_aaa55b7239bfb912dcdaaf2190ee20b65"><div class="ttname"><a href="ath__array_8c.html#aaa55b7239bfb912dcdaaf2190ee20b65">calloc_3d_array</a></div><div class="ttdeci">void *** calloc_3d_array(size_t nt, size_t nr, size_t nc, size_t size)</div><div class="ttdoc">Construct 3D array = array[nt][nr][nc]. </div><div class="ttdef"><b>Definition:</b> <a href="ath__array_8c_source.html#l00078">ath_array.c:78</a></div></div>
<div class="ttc" id="struct_cons_s_html"><div class="ttname"><a href="struct_cons_s.html">ConsS</a></div><div class="ttdoc">Conserved variables. IMPORTANT!! The order of the elements in ConsS CANNOT be changed. </div></div>
<div class="ttc" id="linear__wave1d_8c_html_a2c334369ab621e9815591c76ccfb5fc7"><div class="ttname"><a href="linear__wave1d_8c.html#a2c334369ab621e9815591c76ccfb5fc7">problem_write_restart</a></div><div class="ttdeci">void problem_write_restart(MeshS *pM, FILE *fp)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00344">linear_wave1d.c:344</a></div></div>
<div class="ttc" id="linear__wave1d_8c_html_a4575c4cdbf2965a9857c45970d736676"><div class="ttname"><a href="linear__wave1d_8c.html#a4575c4cdbf2965a9857c45970d736676">get_usr_expr</a></div><div class="ttdeci">ConsFun_t get_usr_expr(const char *expr)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00367">linear_wave1d.c:367</a></div></div>
<div class="ttc" id="linear__wave1d_8c_html_a5506a1df41ed88e038443271b9785337"><div class="ttname"><a href="linear__wave1d_8c.html#a5506a1df41ed88e038443271b9785337">Userwork_after_loop</a></div><div class="ttdeci">void Userwork_after_loop(MeshS *pM)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00403">linear_wave1d.c:403</a></div></div>
<div class="ttc" id="par__circ_8c_html_ae5cb967283dbbdf75cb2032c1fa08fee"><div class="ttname"><a href="par__circ_8c.html#ae5cb967283dbbdf75cb2032c1fa08fee">name</a></div><div class="ttdeci">char name[50]</div><div class="ttdef"><b>Definition:</b> <a href="par__circ_8c_source.html#l00053">par_circ.c:53</a></div></div>
<div class="ttc" id="par__epicycle_8c_html_ad5a0b25666982c302ce2cc5597eb95d3"><div class="ttname"><a href="par__epicycle_8c.html#ad5a0b25666982c302ce2cc5597eb95d3">amp</a></div><div class="ttdeci">Real amp</div><div class="ttdef"><b>Definition:</b> <a href="par__epicycle_8c_source.html#l00056">par_epicycle.c:56</a></div></div>
<div class="ttc" id="streaming2d__single_8c_html_a0e63b0ad913b68a68ba39aa88ab60cb3"><div class="ttname"><a href="streaming2d__single_8c.html#a0e63b0ad913b68a68ba39aa88ab60cb3">s</a></div><div class="ttdeci">Real s</div><div class="ttdef"><b>Definition:</b> <a href="streaming2d__single_8c_source.html#l00057">streaming2d_single.c:57</a></div></div>
<div class="ttc" id="linear__wave1d_8c_html_a0ff640c24db1dc0d7c89d91f1d55ffce"><div class="ttname"><a href="linear__wave1d_8c.html#a0ff640c24db1dc0d7c89d91f1d55ffce">Userwork_in_loop</a></div><div class="ttdeci">void Userwork_in_loop(MeshS *pM)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00391">linear_wave1d.c:391</a></div></div>
<div class="ttc" id="linear__wave1d_8c_html_a1b323f47153f1975b64382e0ffac6b73"><div class="ttname"><a href="linear__wave1d_8c.html#a1b323f47153f1975b64382e0ffac6b73">problem</a></div><div class="ttdeci">void problem(DomainS *pDomain)</div><div class="ttdef"><b>Definition:</b> <a href="linear__wave1d_8c_source.html#l00042">linear_wave1d.c:42</a></div></div>
<div class="ttc" id="struct_mesh_s_html"><div class="ttname"><a href="struct_mesh_s.html">MeshS</a></div><div class="ttdoc">Information about entire mesh hierarchy, including array of Domains. </div></div>
<div class="ttc" id="rsolvers_2prototypes_8h_html_aec330950c874b52ea896e87bf5c510de"><div class="ttname"><a href="rsolvers_2prototypes_8h.html#aec330950c874b52ea896e87bf5c510de">esys_roe_adb_hyd</a></div><div class="ttdeci">void esys_roe_adb_hyd(const Real v1, const Real v2, const Real v3, const Real h, Real eigenvalues[], Real right_eigenmatrix[][5], Real left_eigenmatrix[][5])</div></div>
<div class="ttc" id="ath__log_8c_html_a4d9be5e0a6376ae96b3de9d9bb754c10"><div class="ttname"><a href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10">ath_pout</a></div><div class="ttdeci">int ath_pout(const int level, const char *fmt,...)</div><div class="ttdoc">Output variable argument string to "output log file". </div><div class="ttdef"><b>Definition:</b> <a href="ath__log_8c_source.html#l00277">ath_log.c:277</a></div></div>
<div class="ttc" id="cc__pos_8c_html_a9204d609430c459b0ace484b66dca353"><div class="ttname"><a href="cc__pos_8c.html#a9204d609430c459b0ace484b66dca353">cc_pos</a></div><div class="ttdeci">void cc_pos(const GridS *pG, const int i, const int j, const int k, Real *px1, Real *px2, Real *px3)</div><div class="ttdoc">given i,j,k returns cell-centered x1,x2,x3 </div><div class="ttdef"><b>Definition:</b> <a href="cc__pos_8c_source.html#l00036">cc_pos.c:36</a></div></div>
<div class="ttc" id="ath__files_8c_html_a4c77811377d9605b4a52b830515b2a62"><div class="ttname"><a href="ath__files_8c.html#a4c77811377d9605b4a52b830515b2a62">ath_fname</a></div><div class="ttdeci">char * ath_fname(const char *path, const char *basename, const char *levstr, const char *domstr, const int dlen, const int idump, const char *id, const char *ext)</div><div class="ttdoc">Creates descriptive output filenames. </div><div class="ttdef"><b>Definition:</b> <a href="ath__files_8c_source.html#l00041">ath_files.c:41</a></div></div>
<div class="ttc" id="par_8c_html_ac03bbd5713f3a93db722aea8d1c1b5c0"><div class="ttname"><a href="par_8c.html#ac03bbd5713f3a93db722aea8d1c1b5c0">par_geti</a></div><div class="ttdeci">int par_geti(char *block, char *name)</div><div class="ttdoc">Return an integer. </div><div class="ttdef"><b>Definition:</b> <a href="par_8c_source.html#l00267">par.c:267</a></div></div>
<div class="ttc" id="copyright_8h_html"><div class="ttname"><a href="copyright_8h.html">copyright.h</a></div><div class="ttdoc">Copyright and license information. </div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 22 2015 21:26:25 for Atmospheric Athena by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
