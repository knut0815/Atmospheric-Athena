<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>Atmospheric Athena: Atmospheric-Athena/src/prob/linear_wave3d.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Atmospheric Athena
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d72a5be45d0550369e5d60be167cce07.html">Atmospheric-Athena</a></li><li class="navelem"><a class="el" href="dir_d0e7bb5c4ff29ebf76eab911196cb2f6.html">src</a></li><li class="navelem"><a class="el" href="dir_e13a19de2a85be7802e3bc4dc41d6306.html">prob</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">linear_wave3d.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Linear wave problem generator for 3D problems.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="copyright_8h_source.html">copyright.h</a>&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;defs.h&quot;</code><br />
<code>#include &quot;<a class="el" href="athena_8h_source.html">athena.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="globals_8h_source.html">globals.h</a>&quot;</code><br />
<code>#include &quot;prototypes.h&quot;</code><br />
</div>
<p><a href="linear__wave3d_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a1b323f47153f1975b64382e0ffac6b73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#a1b323f47153f1975b64382e0ffac6b73">problem</a> (<a class="el" href="struct_domain_s.html">DomainS</a> *pDomain)</td></tr>
<tr class="separator:a1b323f47153f1975b64382e0ffac6b73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c334369ab621e9815591c76ccfb5fc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#a2c334369ab621e9815591c76ccfb5fc7">problem_write_restart</a> (<a class="el" href="struct_mesh_s.html">MeshS</a> *pM, FILE *fp)</td></tr>
<tr class="separator:a2c334369ab621e9815591c76ccfb5fc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf733c9792756cbec1e9d226c4ff37ab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#acf733c9792756cbec1e9d226c4ff37ab">problem_read_restart</a> (<a class="el" href="struct_mesh_s.html">MeshS</a> *pM, FILE *fp)</td></tr>
<tr class="separator:acf733c9792756cbec1e9d226c4ff37ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4575c4cdbf2965a9857c45970d736676"><td class="memItemLeft" align="right" valign="top"><a class="el" href="athena_8h.html#aaa64b3ee5eefc566b7c09368c414de89">ConsFun_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#a4575c4cdbf2965a9857c45970d736676">get_usr_expr</a> (const char *expr)</td></tr>
<tr class="separator:a4575c4cdbf2965a9857c45970d736676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b8cabb1061d5399fb492be89de213ff"><td class="memItemLeft" align="right" valign="top"><a class="el" href="athena_8h.html#a8bc2403d4d3a27d6f475f2dc6acc94cc">VOutFun_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#a8b8cabb1061d5399fb492be89de213ff">get_usr_out_fun</a> (const char *<a class="el" href="streaming3d__single_8c.html#ae5cb967283dbbdf75cb2032c1fa08fee">name</a>)</td></tr>
<tr class="separator:a8b8cabb1061d5399fb492be89de213ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff640c24db1dc0d7c89d91f1d55ffce"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#a0ff640c24db1dc0d7c89d91f1d55ffce">Userwork_in_loop</a> (<a class="el" href="struct_mesh_s.html">MeshS</a> *pM)</td></tr>
<tr class="separator:a0ff640c24db1dc0d7c89d91f1d55ffce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5506a1df41ed88e038443271b9785337"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="linear__wave3d_8c.html#a5506a1df41ed88e038443271b9785337">Userwork_after_loop</a> (<a class="el" href="struct_mesh_s.html">MeshS</a> *pM)</td></tr>
<tr class="separator:a5506a1df41ed88e038443271b9785337"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Linear wave problem generator for 3D problems. </p>
<p>PURPOSE: Linear wave problem generator for 3D problems. The generalization of linear_wave.c to handle 1D, 2D, and 3D problems seemed more complex than neccessary, so this special routine has been written to handle only 3D problems. This routine automatically sets the wavevector along the domain diagonal (cannot run grid-aligned waves).</p>
<p>Can be used for either standing (problem/vflow=1.0) or travelling (problem/vflow=0.0) waves.</p>
<p>Configure &ndash;with-gravity=fft to check Jeans stability of plane waves propagating parallel to grid.</p>
<p>Configure &ndash;enable-resistivity and/or &ndash;with-viscosity=ns to check damping of linear waves by resistivity/ambipolar diffusion and/or viscosity</p>
<p>This code is most easily understood in terms of a one dimensional problem in the coordinate system (x,y,z). Two coordinate rotations are applied to obtain a new wave vector in a 3D space in the (x1,x2,x3) coordinate system.</p>
<p>First rotate about the y axis:</p><ul>
<li>x' = x*cos(ang_2) - z*sin(ang_2)</li>
<li>y' = y</li>
<li>z' = x*sin(ang_2) + z*cos(ang_2)</li>
</ul>
<p>Next rotate about the z' axis:</p><ul>
<li>x = x'*cos(ang_3) - y'*sin(ang_3)</li>
<li>y = x'*sin(ang_3) + y'*cos(ang_3)</li>
<li>z = z'</li>
</ul>
<p>Expanding this out we get:</p><ul>
<li>x1 = x*cos(ang_2)*cos(ang_3) - y*sin(ang_3) - z*sin(ang_2)*cos(ang_3)</li>
<li>x2 = x*cos(ang_2)*sin(ang_3) - y*cos(ang_3) - z*sin(ang_2)*sin(ang_3)</li>
<li>x3 = x*sin(ang_2) + z*cos(ang_2)</li>
</ul>
<p>This inverts to:</p><ul>
<li>x = x1*cos(ang_2)*cos(ang_3) + x2*cos(ang_2)*sin(ang_3) + x3*sin(ang_2)</li>
<li>y = -x1*sin(ang_3) + x2*cos(ang_3)</li>
<li>z = -x1*sin(ang_2)*cos(ang_3) - x2*sin(ang_2)*sin(ang_3) + x3*cos(ang_2)</li>
</ul>
<p>The magnetic field is given by:</p><ul>
<li>B_x = b_par</li>
<li>B_y = b_perp*cos(k*x)</li>
<li>B_z = b_perp*sin(k*x) where k = 2.0*PI/lambda</li>
</ul>
<p>PRIVATE FUNCTION PROTOTYPES:</p><ul>
<li>A1() - 1-component of vector potential for initial conditions</li>
<li>A2() - 2-component of vector potential for initial conditions</li>
<li><a class="el" href="cylfieldloop_8c.html#a08fa99b8e1672882848cd99d22d411dc" title="3-component of vector potential ">A3()</a> - 3-component of vector potential for initial conditions</li>
</ul>
<p>USERWORK_AFTER_LOOP function computes L1 error norm in solution by comparing to initial conditions. Problem must be evolved for an integer number of wave periods for this to work (only works for ideal MHD). </p>

<p>Definition in file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a4575c4cdbf2965a9857c45970d736676"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="athena_8h.html#aaa64b3ee5eefc566b7c09368c414de89">ConsFun_t</a> get_usr_expr </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>expr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00436">436</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8b8cabb1061d5399fb492be89de213ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="athena_8h.html#a8bc2403d4d3a27d6f475f2dc6acc94cc">VOutFun_t</a> get_usr_out_fun </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00441">441</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1b323f47153f1975b64382e0ffac6b73"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void problem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_domain_s.html">DomainS</a> *&#160;</td>
          <td class="paramname"><em>pDomain</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00100">100</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="linear__wave3d_8c_a1b323f47153f1975b64382e0ffac6b73_cgraph.png" border="0" usemap="#linear__wave3d_8c_a1b323f47153f1975b64382e0ffac6b73_cgraph" alt=""/></div>
<map name="linear__wave3d_8c_a1b323f47153f1975b64382e0ffac6b73_cgraph" id="linear__wave3d_8c_a1b323f47153f1975b64382e0ffac6b73_cgraph">
<area shape="rect" id="node2" href="prototypes_8h.html#ab4a402b1bd69e8f49435ee8fe45ecce6" title="Terminate execution and output error message Uses variable&#45;length argument lists provided in &lt;stdarg..." alt="" coords="478,49,554,76"/><area shape="rect" id="node4" href="ath__array_8c.html#aaa55b7239bfb912dcdaaf2190ee20b65" title="Construct 3D array = array[nt][nr][nc]. " alt="" coords="313,49,429,76"/><area shape="rect" id="node5" href="par_8c.html#ac03bbd5713f3a93db722aea8d1c1b5c0" title="Return an integer. " alt="" coords="159,100,230,127"/><area shape="rect" id="node6" href="par_8c.html#ac234e8c1085523fa6adcd6d4f48281b5" title="Return a Real value. " alt="" coords="157,151,232,177"/><area shape="rect" id="node7" href="rsolvers_2prototypes_8h.html#a969e92dbb8d373dd53ddf26af8484dc8" title="ISOTHERMAL HYDRO. " alt="" coords="130,201,259,228"/><area shape="rect" id="node8" href="rsolvers_2prototypes_8h.html#aec330950c874b52ea896e87bf5c510de" title="esys_roe_adb_hyd" alt="" coords="127,252,262,279"/><area shape="rect" id="node9" href="ath__log_8c.html#a4d9be5e0a6376ae96b3de9d9bb754c10" title="Output variable argument string to &quot;output log file&quot;. " alt="" coords="158,303,231,329"/><area shape="rect" id="node10" href="rsolvers_2prototypes_8h.html#a24d020d44742ab1c876ca77a0780a8c4" title="ISOTHERMAL MHD. " alt="" coords="128,353,261,380"/><area shape="rect" id="node11" href="rsolvers_2prototypes_8h.html#a4c072a7acb3407ef179cb922028efb2e" title="esys_roe_adb_mhd" alt="" coords="125,404,264,431"/><area shape="rect" id="node12" href="cc__pos_8c.html#a9204d609430c459b0ace484b66dca353" title="given i,j,k returns cell&#45;centered x1,x2,x3 " alt="" coords="163,455,227,481"/><area shape="rect" id="node13" href="cylfieldloop_8c.html#a08fa99b8e1672882848cd99d22d411dc" title="3&#45;component of vector potential " alt="" coords="175,505,214,532"/><area shape="rect" id="node14" href="ath__array_8c.html#aa639a50b59af0bc55505fe267a0ec5a1" title="Free memory used by 3D array. " alt="" coords="142,556,247,583"/><area shape="rect" id="node15" href="par_8c.html#a0f36a2890d652e2c2ca86d72c91cc8cf" title="Return double *name in *block if it exists, else use the double def as a default value. " alt="" coords="145,607,245,633"/><area shape="rect" id="node3" href="ath__log_8c.html#ad4fe019acf86bdfb9ab014b2f3ab10da" title="Open error file if needed and return a pointer to file. " alt="" coords="603,49,679,76"/><area shape="rect" id="node16" href="par_8c.html#ad7ff0f7b4cee0ec0751000359a117093" title="Return 0 or 1 if a block/name exists. " alt="" coords="333,328,409,355"/><area shape="rect" id="node17" href="par_8c.html#aca86a680715a5deb34d96dc9d4279edd" title="Set or add a double. " alt="" coords="334,607,407,633"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acf733c9792756cbec1e9d226c4ff37ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void problem_read_restart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_mesh_s.html">MeshS</a> *&#160;</td>
          <td class="paramname"><em>pM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00431">431</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2c334369ab621e9815591c76ccfb5fc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void problem_write_restart </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_mesh_s.html">MeshS</a> *&#160;</td>
          <td class="paramname"><em>pM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00426">426</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5506a1df41ed88e038443271b9785337"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Userwork_after_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_mesh_s.html">MeshS</a> *&#160;</td>
          <td class="paramname"><em>pM</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00467">467</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="linear__wave3d_8c_a5506a1df41ed88e038443271b9785337_cgraph.png" border="0" usemap="#linear__wave3d_8c_a5506a1df41ed88e038443271b9785337_cgraph" alt=""/></div>
<map name="linear__wave3d_8c_a5506a1df41ed88e038443271b9785337_cgraph" id="linear__wave3d_8c_a5506a1df41ed88e038443271b9785337_cgraph">
<area shape="rect" id="node2" href="ath__files_8c.html#a4c77811377d9605b4a52b830515b2a62" title="Creates descriptive output filenames. " alt="" coords="200,5,285,32"/><area shape="rect" id="node3" href="ath__log_8c.html#af21347278c9b783a269474386c4289c5" title="Foutput variable argument string to &quot;error log file&quot;. " alt="" coords="207,56,279,83"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0ff640c24db1dc0d7c89d91f1d55ffce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Userwork_in_loop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_mesh_s.html">MeshS</a> *&#160;</td>
          <td class="paramname"><em>pM</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="linear__wave3d_8c_source.html#l00457">457</a> of file <a class="el" href="linear__wave3d_8c_source.html">linear_wave3d.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jun 22 2015 21:26:26 for Atmospheric Athena by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
